import { useRef } from 'react';
import { motion, useScroll, useTransform } from 'framer-motion';

const Word = ({ scrollYProgress, index, totalWords, word }) => {
  const start = index / totalWords;
  const end = (index + 1) / totalWords;
  
  const clampedStart = Math.max(0, Math.min(1, start));
  const clampedEnd = Math.max(0, Math.min(1, end));
  
  const opacity = useTransform(scrollYProgress, [clampedStart, clampedEnd], [0, 1]);
  const blur = useTransform(scrollYProgress, [clampedStart, clampedEnd], [10, 0]);
  
  return (
    <motion.span
      style={{ 
        opacity, 
        filter: `blur(${blur}px)`,
        display: 'inline-block',
        margin: '0 4px'
      }}
    >
      {word}
    </motion.span>
  );
};

export default function App() {
  const containerRef = useRef(null);
  const { scrollYProgress } = useScroll({
    target: containerRef,
    offset: ["start start", "end start"]
  });

  const text = "As you scroll down this page, each word will gradually appear with a beautiful blur effect. When scrolling up, the words will disappear in reverse order, creating a magical reading experience. This smooth animation guides your attention naturally through the content while maintaining an elegant visual flow. The effect works seamlessly across all device sizes and enhances user engagement without being distracting. Modern web technologies enable these sophisticated interactions that transform simple text into captivating storytelling experiences.";
  
  const words = text.split(' ');

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-violet-800 text-white overflow-x-hidden">
      <motion.div 
        ref={containerRef}
        className="relative h-[300vh] w-full"
      >
        <div className="sticky top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl px-4 text-center">
          <div className="text-2xl md:text-4xl font-bold leading-relaxed tracking-tight">
            {words.map((word, index) => (
              <Word 
                key={index} 
                scrollYProgress={scrollYProgress} 
                index={index} 
                totalWords={words.length} 
                word={word} 
              />
            ))}
          </div>
        </div>
        
        <div className="absolute bottom-8 left-1/2 transform -translate-x-1/2 text-center opacity-70">
          <p className="text-lg mb-2">Scroll down to reveal the text</p>
          <motion.div
            animate={{ y: [0, 10, 0] }}
            transition={{ duration: 1.5, repeat: Infinity }}
            className="mx-auto w-8 h-8 border-2 border-white rounded-full flex items-center justify-center"
          >
            <motion.div
              animate={{ opacity: [0.3, 1, 0.3] }}
              transition={{ duration: 1.5, repeat: Infinity }}
              className="w-2 h-4 bg-white rounded-full"
            />
          </motion.div>
        </div>
      </motion.div>
    </div>
  );
}
